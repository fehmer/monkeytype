import Config from "../config";
import { capitalizeFirstLetterOfEachWord } from "../utils/strings";

type ExceptionRule = { britishWord: string; exceptPreviousWords: string[] };
type BritishEnglishReplacements = Record<
  string /*EnglishWord*/,
  string /*BritishWord*/ | ExceptionRule
>;

const replacementRules: BritishEnglishReplacements = {
  abettor: "abetter",
  abolitionize: "abolitionise",
  abridgment: "abridgement",
  acclimate: "acclimatise",
  acclimated: "acclimatised",
  acclimating: "acclimatising",
  acclimation: "acclimatisation",
  acclimatization: "acclimatisation",
  acclimatize: "acclimatise",
  acclimatized: "acclimatised",
  acclimatizing: "acclimatising",
  accouterments: "accoutrements",
  accouter: "accoutre",
  actualization: "actualisation",
  adviser: "advisor",
  aerie: "eyrie",
  aggrandize: "aggrandise",
  aggrandizement: "aggrandisement",
  aging: "ageing",
  agonize: "agonise",
  agonized: "agonised",
  agonizes: "agonises",
  agonizing: "agonising",
  aggrandizes: "aggrandises",
  airdrome: "aerodrome",
  airplane: "aeroplane",
  alleluia: "halleluiah",
  alphabetized: "alphabetised",
  althea: "althaea",
  aluminum: "aluminium",
  amenorrhea: "amenorrhoea",
  amorist: "amourist",
  amortize: "amortise",
  amphitheater: "amphitheatre",
  analog: "analogue",
  analyze: "analyse",
  analyzed: "analysed",
  analyzer: "analyser",
  analyzing: "analysing",
  anapest: "anapaest",
  anapestic: "anapaestic",
  anemia: "anaemia",
  anesthesia: "anaesthesia",
  anesthetic: "anaesthetic",
  anglicize: "anglicise",
  anglicized: "anglicised",
  antagonize: "antagonise",
  apologize: "apologise",
  apologized: "apologised",
  apothegm: "apophthegm",
  appall: "appal",
  appetizer: "appetiser",
  arbor: "arbour",
  arbors: "arbours",
  armor: "armour",
  armored: "armoured",
  armorer: "armourer",
  armory: "armoury",
  artifact: "artefact",
  arytenoid: "arytaenoid",
  ascendance: "ascendence",
  asses: "arses",
  asshole: "arsehole",
  atomizer: "atomiser",
  authorization: "authorisation",
  authorize: "authorise",
  authorized: "authorised",
  bandoleer: "bandolier",
  baptize: "baptise",
  barbecue: "barbeque",
  bastardize: "bastardise",
  bastardized: "bastardised",
  behavior: "behaviour",
  behavioral: "behavioural",
  behaviors: "behaviours",
  behoove: "behove",
  belabor: "belabour",
  biased: "biassed",
  blond: "blonde",
  botanize: "botanise",
  brant: "brent",
  brier: "briar",
  bronco: "broncho",
  brunet: "brunette",
  brutalization: "brutalisation",
  burglarize: "burglarise",
  busses: "buses",
  caftan: "kaftan",
  caiman: "cayman",
  canceled: "cancelled",
  candor: "candour",
  cannibalize: "cannibalise",
  canonization: "canonisation",
  capitalization: "capitalisation",
  capitalize: "capitalise",
  carbonization: "carbonisation",
  caster: "castor",
  catalog: "catalogue",
  cataloged: "catalogued",
  cataloger: "cataloguer",
  catalogers: "cataloguers",
  cataloging: "cataloguing",
  catalogs: "catalogues",
  categorization: "categorisation",
  categorize: "categorise",
  categorized: "categorised",
  cauterization: "cauterisation",
  cauterize: "cauterise",
  center: "centre",
  centered: "centred",
  centers: "centres",
  centimeter: "centimetre",
  centralization: "centralisation",
  chamois: "shammy",
  chanty: "shanty",
  characterization: "characterisation",
  characterize: "characterise",
  characterized: "characterised",
  checker: "chequer",
  checkered: "chequered",
  chili: "chilli",
  chitterlings: "chitlins",
  chivy: "chivvy",
  christianization: "christianisation",
  cicatrix: "cicatrice",
  cipher: "cypher",
  civilization: "civilisation",
  civilize: "civilise",
  civilized: "civilised",
  clamor: "clamour",
  cognizance: "cognisance",
  cognizant: "cognisant",
  cognize: "cognise",
  collectible: "collectable",
  colonization: "colonisation",
  colonize: "colonise",
  color: "colour",
  coloration: "colouration",
  colored: "coloured",
  colorful: "colourful",
  coloring: "colouring",
  colorless: "colourless",
  colorlessness: "colourlessness",
  colors: "colours",
  colter: "coulter",
  combated: "combatted",
  commercialization: "commercialisation",
  commercialize: "commercialise",
  computerization: "computerisation",
  concenter: "concentre",
  conceptualization: "conceptualisation",
  containerization: "containerisation",
  cony: "coney",
  counseling: "counselling",
  counselor: "counsellor",
  criticize: "criticise",
  criticized: "criticised",
  criticizing: "criticising",
  crystallization: "crystallisation",
  customization: "customisation",
  customizations: "customisations",
  customize: "customise",
  customized: "customised",
  customizer: "customiser",
  customizers: "customisers",
  customizes: "customises",
  customizing: "customising",
  czar: "tzar",
  czarina: "tzarina",
  decentralization: "decentralisation",
  decimeter: "decimetre",
  defense: "defence",
  defenses: "defences",
  demagogism: "demagoguism",
  demeanor: "demeanour",
  demobilization: "demobilisation",
  demoralization: "demoralisation",
  denationalization: "denationalisation",
  deodorization: "deodorisation",
  depolarization: "depolarisation",
  deputize: "deputise",
  desalination: "desalinisation",
  dexterous: "dextrous",
  dexterously: "dextrously",
  diarrhea: "diarrhoea",
  dieresis: "diaeresis",
  discolor: "discolour",
  discoloration: "discolouration",
  discolored: "discoloured",
  dishabille: "deshabille",
  dishonor: "dishonour",
  disorganization: "disorganisation",
  disorganized: "disorganised",
  distill: "distil",
  dolor: "dolour",
  draftsman: "draughtsman",
  draftsmen: "draughtsmen",
  dramatization: "dramatisation",
  dysmenorrhea: "dysmenorrhoea",
  dyspnea: "dyspnoea",
  economize: "economise",
  edema: "oedema",
  edile: "aedile",
  empathize: "empathise",
  emphasize: "emphasise",
  emphasized: "emphasised",
  emphasizes: "emphasises",
  emphasizing: "emphasising",
  enamor: "enamour",
  enamored: "enamoured",
  encyclopedias: "encyclopaedias",
  endeavor: "endeavour",
  endeavored: "endeavoured",
  endeavoring: "endeavouring",
  endeavors: "endeavours",
  enroll: "enrol",
  enrollment: "enrolment",
  enthrall: "enthral",
  epaulet: "epaulette",
  epitomize: "epitomise",
  equalization: "equalisation",
  equalizer: "equaliser",
  esophageal: "oesophageal",
  esophagus: "oesophagus",
  esthetic: "aesthetic",
  estival: "aestival",
  estivation: "aestivation",
  evangelization: "evangelisation",
  evangelize: "evangelise",
  extemporization: "extemporisation",
  extemporize: "extemporise",
  externalization: "externalisation",
  eulogize: "eulogise",
  europeanize: "europeanise",
  favor: "favour",
  favorable: "favourable",
  favorably: "favourably",
  favoring: "favouring",
  favorite: "favourite",
  favorites: "favourites",
  favoritism: "favouritism",
  favors: "favours",
  fecal: "faecal",
  feminization: "feminisation",
  fertilization: "fertilisation",
  fertilize: "fertilise",
  fertilized: "fertilised",
  fertilizer: "fertiliser",
  fertilizes: "fertilises",
  fertilizing: "fertilising",
  fervor: "fervour",
  fetus: "foetus",
  feudalization: "feudalisation",
  fiber: "fibre",
  fibers: "fibres",
  finalize: "finalise",
  flavor: "flavour",
  flavoring: "flavouring",
  flavors: "flavours",
  fledgling: "fledgeling",
  flier: "flyer",
  flotation: "floatation",
  fogy: "fogey",
  fontanel: "fontanelle",
  fossilization: "fossilisation",
  fossilize: "fossilise",
  fossilized: "fossilised",
  fraternization: "fraternisation",
  fraternize: "fraternise",
  fulfill: "fulfil",
  fullness: "fulness",
  furor: "furore",
  fuze: "fuse",
  galvanize: "galvanise",
  gasoline: "petrol",
  gases: "gasses",
  generalization: "generalisation",
  generalize: "generalise",
  generalized: "generalised",
  globalization: "globalisation",
  glycerin: "glycerine",
  goiter: "goitre",
  gonorrhea: "gonorrhoea",
  granddad: "grandad",
  gray: "grey",
  grays: "greys",
  guerrilla: "guerilla",
  gynecologist: "gynaecologist",
  harbor: "harbour",
  harbored: "harboured",
  harmonization: "harmonisation",
  harmonize: "harmonise",
  hebraizing: "hebraising",
  hematology: "haematology",
  heme: "haem",
  hemoglobin: "haemoglobin",
  hippie: "hippy",
  honor: "honour",
  honorable: "honourable",
  honored: "honoured",
  honors: "honours",
  hospitalization: "hospitalisation",
  humanization: "humanisation",
  humor: "humour",
  humorous: "humourous",
  hurrah: "hooray",
  hybridization: "hybridisation",
  hyena: "hyaena",
  hyperesthesia: "hyperaesthesia",
  hypnotized: "hypnotised",
  hypothesize: "hypothesise",
  idealization: "idealisation",
  idealize: "idealise",
  idealized: "idealised",
  idolization: "idolisation",
  immobilization: "immobilisation",
  immunization: "immunisation",
  individualization: "individualisation",
  industrialization: "industrialisation",
  industrialize: "industrialise",
  industrialized: "industrialised",
  initialization: "initialisation",
  internationalization: "internationalisation",
  iodized: "iodised",
  ionization: "ionisation",
  ionize: "ionise",
  ionizing: "ionising",
  italicize: "italicise",
  jailer: "jailor",
  jeopardize: "jeopardise",
  jeweler: "jeweller",
  jewelry: "jewellery",
  jihad: "jehad",
  jinni: "jinn",
  judgment: "judgement",
  judgments: "judgements",
  kerosene: "kerosine",
  kilometer: "kilometre",
  kilometers: "kilometres",
  kinesthetic: "kinaesthetic",
  kopeck: "kopek",
  labor: "labour",
  laborer: "labourer",
  laborers: "labourers",
  labeled: "labelled",
  labeling: "labelling",
  lachrymal: "lacrimal",
  lackluster: "lacklustre",
  lambaste: "lambast",
  latinize: "latinise",
  laureled: "laurelled",
  legalization: "legalisation",
  legalize: "legalise",
  legitimize: "legitimise",
  leukemia: "leukaemia",
  leveler: "leveller",
  libeler: "libeller",
  libeling: "libelling",
  libelous: "libellous",
  liberalize: "liberalise",
  license: "licence",
  licensed: "licenced",
  licenses: "licences",
  licensing: "licencing",
  licorice: "liquorice",
  likable: "likeable",
  linchpin: "lynchpin",
  lionize: "lionise",
  lissome: "lissom",
  liter: "litre",
  localization: "localisation",
  localize: "localise",
  louver: "louvre",
  lupine: "lupin",
  luster: "lustre",
  lusterless: "lustreless",
  macadamize: "macadamise",
  magnetization: "magnetisation",
  magnetize: "magnetise",
  magnetizer: "magnetiser",
  majolica: "maiolica",
  malodor: "malodour",
  maneuver: "manoeuvre",
  manikin: "mannikin",
  marvelous: "marvellous",
  math: "maths",
  maximize: "maximise",
  mazurka: "mazourka",
  meager: "meagre",
  meagerly: "meagrely",
  meagerness: "meagreness",
  mechanization: "mechanisation",
  mechanize: "mechanise",
  memorization: "memorisation",
  memorize: "memorise",
  mesmerize: "mesmerise",
  mesmerized: "mesmerised",
  mesquite: "mesquit",
  meter: "metre",
  meters: "metres",
  micrometer: "micrometre",
  millimeter: "millimetre",
  minimize: "minimise",
  minuscule: "miniscule",
  misbehavior: "misbehaviour",
  misdemeanor: "misdemeanour",
  mobilize: "mobilise",
  modeling: "modelling",
  modernization: "modernisation",
  modernize: "modernise",
  moisturize: "moisturise",
  moisturized: "moisturised",
  moisturizes: "moisturises",
  moisturizing: "moisturising",
  mold: "mould",
  molding: "moulding",
  moldy: "mouldy",
  mollusk: "mollusc",
  molt: "moult",
  mom: "mum",
  mommy: "mummy",
  "mom'l": "mum'll",
  monopolize: "monopolise",
  moralize: "moralise",
  mousy: "mousey",
  multicolor: "multicolour",
  mustache: "moustache",
  mustachioed: "moustachioed",
  nationalization: "nationalisation",
  neighbor: "neighbour",
  neighbored: "neighboured",
  neighborhood: "neighbourhood",
  neighborhoods: "neighbourhoods",
  neighboring: "neighbouring",
  neighborly: "neighbourly",
  neighbors: "neighbours",
  neutralize: "neutralise",
  nightie: "nighty",
  niter: "nitre",
  nitrogenized: "nitrogenised",
  normalization: "normalisation",
  nosy: "nosey",
  novelization: "novelisation",
  numskull: "numbskull",
  odor: "odour",
  odorless: "odourless",
  odorous: "odourous",
  offense: "offence",
  omelet: "omelette",
  optimization: "optimisation",
  optimize: "optimise",
  optimized: "optimised",
  organdy: "organdie",
  organization: "organisation",
  organizational: "organisational",
  organizations: "organisations",
  organize: "organise",
  organized: "organised",
  organizer: "organiser",
  organizers: "organisers",
  organizing: "organising",
  orthopedic: "orthopaedic",
  orthopedics: "orthopaedics",
  ostracize: "ostracise",
  overdraft: "overdraught",
  oxidize: "oxidise",
  pajamas: "pyjamas",
  paleolithic: "palaeolithic",
  paleontologist: "palaeontologist",
  paleontology: "palaeontology",
  paleozoic: "palaeozoic",
  paneling: "panelling",
  paralyze: "paralyse",
  parlor: "parlour",
  pasteurize: "pasteurise",
  patronize: "patronise",
  pawpaw: "papaya",
  paycheck: "paycheque",
  peddler: "pedlar",
  pediatric: "paediatric",
  pediatrics: "paediatrics",
  penalize: "penalise",
  personalized: "personalised",
  piscine: "piscinae",
  plagiarize: "plagiarise",
  plow: "plough",
  plowing: "ploughing",
  polarization: "polarisation",
  popularize: "popularise",
  popularized: "popularised",
  polymerization: "polymerisation",
  practice: "practise",
  practicing: "practising",
  premunire: "praemunire",
  pretense: "pretence",
  privatization: "privatisation",
  prizer: "priser",
  programs: "programmes",
  proselytize: "proselytise",
  publicize: "publicise",
  pulverize: "pulverise",
  racket: "racquet",
  rajah: "raja",
  rancor: "rancour",
  rationalization: "rationalisation",
  rationalize: "rationalise",
  rationalizing: "rationalising",
  ratline: "ratlin",
  raveling: "ravelling",
  realization: "realisation",
  realize: "realise",
  realized: "realised",
  realizing: "realising",
  recognizable: "recognisable",
  recognize: "recognise",
  recognized: "recognised",
  recognizes: "recognises",
  recognizing: "recognising",
  reconnoiter: "reconnoitre",
  recrystallization: "recrystallisation",
  reorganization: "reorganisation",
  reorganize: "reorganise",
  revitalize: "revitalise",
  revolutionize: "revolutionise",
  rigor: "rigour",
  romanization: "romanisation",
  romanize: "romanise",
  routing: "routeing",
  ruble: "rouble",
  rumor: "rumour",
  rumors: "rumours",
  saber: "sabre",
  salable: "saleable",
  saltpeter: "saltpetre",
  sanatorium: "sanitarium",
  savior: "saviour",
  savor: "savour",
  savory: "savoury",
  scandalize: "scandalise",
  scrutinize: "scrutinise",
  selvage: "selvedge",
  septicemia: "septicaemia",
  sepulcher: "sepulchre",
  shoveler: "shoveller",
  signaling: "signalling",
  skeptic: "sceptic",
  skeptical: "sceptical",
  skepticism: "scepticism",
  skillful: "skilful",
  smolder: "smoulder",
  smoldering: "smouldering",
  sniveling: "snivelling",
  snowplow: "snowplough",
  socialize: "socialise",
  softy: "softie",
  somber: "sombre",
  specialize: "specialise",
  specialized: "specialised",
  specializes: "specialises",
  specializing: "specialising",
  specialties: "specialities",
  specialty: "speciality",
  specter: "spectre",
  stabilization: "stabilisation",
  stabilize: "stabilise",
  standardized: "standardised",
  sterilization: "sterilisation",
  sterilize: "sterilise",
  stigmatize: "stigmatise",
  stogie: "stogy",
  stylized: "stylised",
  stymie: "stymy",
  subsidize: "subsidise",
  succor: "succour",
  summarize: "summarise",
  supersede: "supercede",
  synchronization: "synchronisation",
  synchronize: "synchronise",
  synchronized: "synchronised",
  synthesize: "synthesise",
  synthesizer: "synthesiser",
  taboret: "tabouret",
  tantalize: "tantalise",
  teetotaler: "teetotaller",
  temporize: "temporise",
  temporized: "temporised",
  tendinitis: "tendonitis",
  tenia: "taenia",
  tepee: "teepee",
  terrorize: "terrorise",
  theater: "theatre",
  theaters: "theatres",
  theorize: "theorise",
  tidbit: "titbit",
  tire: { britishWord: "tyre", exceptPreviousWords: ["will"] },
  topee: "topi",
  totaled: "totalled",
  tranquilize: "tranquilise",
  tranquillization: "tranquillisation",
  tranquillized: "tranquillised",
  traveled: "travelled",
  traveler: "traveller",
  travelers: "travellers",
  traveling: "travelling",
  tricolor: "tricolour",
  tumor: "tumour",
  tumors: "tumours",
  tyrannize: "tyrannise",
  unauthorized: "unauthorised",
  uncataloged: "uncatalogued",
  uncategorized: "uncategorised",
  uncivilized: "uncivilised",
  unfavorable: "unfavourable",
  unicolor: "unicolour",
  unpasteurized: "unpasteurised",
  unsavory: "unsavoury",
  untrammeled: "untrammelled",
  urbanization: "urbanisation",
  utilization: "utilisation",
  utilize: "utilise",
  utilizing: "utilising",
  utilized: "utilised",
  valor: "valour",
  vapor: "vapour",
  vaporize: "vaporise",
  vaporware: "vapourware",
  vendor: "vender",
  victimize: "victimise",
  victualer: "victualler",
  visualization: "visualisation",
  visualize: "visualise",
  vitalize: "vitalise",
  vocalize: "vocalise",
  vulcanize: "vulcanise",
  wacky: "whacky",
  wagonette: "waggonette",
  wainscoting: "wainscotting",
  watercolor: "watercolour",
  whimsy: "whimsey",
  whiz: "whizz",
  womanize: "womanise",
  woolen: "woollen",
  worshiped: "worshipped",
  worshiping: "worshipping",
  yodeler: "yodeller",
  yogurt: "yoghurt",
};

export async function replace(
  word: string,
  previousWord: string
): Promise<string> {
  if (word.includes("-")) {
    //this handles hyphenated words (for example "cream-colored") to make sure
    //we don't have to add every possible combination to the list
    return (
      await Promise.all(
        word.split("-").map(async (w) => replace(w, previousWord))
      )
    ).join("-");
  } else {
    const cleanedWord = word.replace(/^[\W]+|[\W]+$/g, "").toLowerCase();
    const rule = replacementRules[cleanedWord];

    if (rule === undefined) return word;

    const [britishWord, exceptions] =
      typeof rule === "string"
        ? [rule, []]
        : [rule.britishWord, rule.exceptPreviousWords];

    if (Config.mode === "quote" && exceptions.includes(previousWord)) {
      return word;
    }

    return word.replace(
      RegExp(`^(?:([\\W]*)(${cleanedWord})([\\W]*))$`, "gi"),
      (_, $1, $2, $3) =>
        $1 +
        (($2 as string).charAt(0) === ($2 as string).charAt(0).toUpperCase()
          ? $2 === ($2 as string).toUpperCase()
            ? britishWord.toUpperCase()
            : capitalizeFirstLetterOfEachWord(britishWord)
          : britishWord) +
        $3
    );
  }
}
